Id: cf49f43c-d7b4-4c1a-a40d-1be36ea64bff
Author: Michael Haag
Created: '2023-05-22'
MitreID: T1068
Category: vulnerable driver
Verified: 'TRUE'
Commands:
  Command: sc.exe create SysDrv3S.sys binPath=C:\windows\temp\SysDrv3S.sys type=kernel
    && sc.exe start SysDrv3S.sys
  Description: Vulnerable driver found in https://github.com/hfiref0x/KDU.
  Usecase: Elevate privileges
  Privileges: kernel
  OperatingSystem: Windows 10
Resources:
- https://github.com/magicsword-io/LOLDrivers/issues/55#issuecomment-1537161951
Acknowledgement:
  Person: hfiref0x
  Handle: hfiref0x
Detection:
- type: yara_signature
  value: https://github.com/magicsword-io/LOLDrivers/blob/main/detections/yara/0e53b58415fa68552928622118d5b8a3a851b2fc512709a90b63ba46acda8b6b.yara
- type: sigma_hash
  value: https://github.com/magicsword-io/LOLDrivers/blob/main/detections/sigma/driver_load_win_vuln_drivers.yml
- type: sigma_names
  value: https://github.com/magicsword-io/LOLDrivers/blob/main/detections/sigma/driver_load_win_vuln_drivers_names.yml
- type: sysmon_hash_detect
  value: https://github.com/magicsword-io/LOLDrivers/blob/main/detections/sysmon/sysmon_config_vulnerable_hashes.xml
- type: sysmon_hash_block
  value: https://github.com/magicsword-io/LOLDrivers/blob/main/detections/sysmon/sysmon_config_vulnerable_hashes_block.xml
KnownVulnerableSamples:
- Filename: SysDrv3S.sys
  MD5: 31eca8c0b32135850d5a50aee11fec87
  SHA1: e1069365cb580e3525090f2fa28efd4127223588
  SHA256: 0e53b58415fa68552928622118d5b8a3a851b2fc512709a90b63ba46acda8b6b
  Signature: ''
  Date: ''
  Publisher: ''
  Company: 3S-Smart Software Solutions GmbH
  Description: SysDrv3S
  Product: SysDrv3S
  ProductVersion: 3.5.6.0
  FileVersion: 3,5,6,0
  MachineType: AMD64
  OriginalFilename: SysDrv3S.sys
  Authentihash:
    MD5: 0ef111dc998659cbc37f0d9845cdd2df
    SHA1: 432b5809d84935d15574de8d64b22e06682ff715
    SHA256: 97cada65b735f3eece349c7b7021c4469d5a9fb3cf8b5e2ac187006469ffbc98
  InternalName: SysDrv3S
  Copyright: "Copyright \xA9 2006-2014"
  Imports:
  - HAL.dll
  - ntoskrnl.exe
  ExportedFunctions: ''
  ImportedFunctions:
  - HalSetBusDataByOffset
  - HalTranslateBusAddress
  - HalGetBusData
  - IoDeleteDevice
  - IoCreateSymbolicLink
  - IoCreateDevice
  - RtlInitUnicodeString
  - DbgPrint
  - IofCompleteRequest
  - ZwUnmapViewOfSection
  - RtlAssert
  - IoDeleteSymbolicLink
  - ZwClose
  - ZwMapViewOfSection
  - ObReferenceObjectByHandle
  - ZwOpenSection
  - RtlQueryRegistryValues
  - RtlWriteRegistryValue
  - ZwCreateFile
  - ZwReadFile
  - ZwWriteFile
  - ZwQueryInformationFile
  - KeSetEvent
  - KeWaitForSingleObject
  - IofCallDriver
  - KeInitializeEvent
  - IoGetDeviceProperty
  - __C_specific_handler
  - IoDetachDevice
  - RtlFreeUnicodeString
  - IoAttachDeviceToDeviceStack
  - RtlCopyUnicodeString
  - ExAllocatePool
  - PoCallDriver
  - PoStartNextPowerIrp
  - IoFreeIrp
  - IoAllocateIrp
  Signatures:
  - CertificatesInfo: ''
    SignerInfo: ''
    Certificates:
    - Subject: OU=GlobalSign Root CA , R3, O=GlobalSign, CN=GlobalSign
      ValidFrom: '2009-11-18 10:00:00'
      ValidTo: '2019-03-18 10:00:00'
      Signature: 4252a97ea2cf5b3bcb4bddbaf85759d324a47772ef62443782ed06ee04d5165f24a314dc6c54056ab09b3dda8139daad28db956f8183f5cd62b14524b1dd29e5085495958cf01d065f1ad6463f1340174811169b474dd13ab50f571c9230d0f8b2253b0acdf687f9c7b257d33f7da58c14ce9ca8c79f4693da59fa795d652035445a4fc1909dc1549256dc34c8f5c103d05dc059489c00fc95a0f1d176f71636c813927f2d2bc0b880f126261f414d52bf1e97bb018208e715f6c1d5342accf5e4c3877a5781e1d6d74286620177e2a9c47a86f404387a076a7d00ec73f7a80b3478c59eb3efb838400e8c3353c875ec5f3eea755eff820e7415dc1905f3ba31
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
    - Subject: C=BE, O=GlobalSign nv,sa, CN=GlobalSign Extended Validation CodeSigning
        CA , SHA256 , G3
      ValidFrom: '2016-06-15 00:00:00'
      ValidTo: '2024-06-15 00:00:00'
      Signature: 7609c4cc2fd9ef1e4ba9f857f3403921ca4c3c1d9e292b20d42b44d288ce1a0d05cf8381bbeb69bc318d2ac4c744cc6060941ccfa1e102240ead5bbe2cc2271e67b7e8281f3251e339f398dfb89f2e8b2ab47b0a03bcbd36048fc9d09c4fa3022799b0f045e934dfe43aa3b70637d86f2a7990d4d44e5871ec53a96198f73969e0129c575872862729a51de532f32b99975abf2bb03cb406ea0e64ecb7cd65802417c2d937f5b1261035477b9a02ba54a24593ff79bf1a8cc59fb59fdf78e76b50f14794694b24b8da05e80c9d4f06ec4a31207e4f5d86842f35a3cd9cc184571f1fadc0e2a4b1ef296b2197a6d4feed0337b0fcf58d2abcdc8483e3dec3e75f
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
    - Subject: C=BE, O=GlobalSign nv,sa, OU=Root CA, CN=GlobalSign Root CA
      ValidFrom: '2011-04-15 19:55:08'
      ValidTo: '2021-04-15 20:05:08'
      Signature: 5ff8d065746a81c6a6ca5b03b6914ae84bbdef2ba142f0efb4a5adcd3389ec0b9585ac62501108aa58d25aa08310e5a6337af25af2c5fe787cf09c83df190ad97396002dd62ccde914d41d9de83f3c1a76f7904efb01350a6c9313a0c356eb67a0e4d17a96dec267f190f80a7bf5321b94ec5f751f8d1b34da6c58a7cb2d279e2226b7c9aa30cc0777b836e38201b5393ccc8dd9a75f7f23b3877fdb5798918bd7ce2520e39d644fdd87f72b68490318e0a5df7c5f68644d36838d4781f2e9e0a869abfa7b163c05a449ea8830190a6c73055178dfd41ddd3ad47f2de44e54be83431e7a7433b4a4ebd77073bc2a02988966eef6bc8f749378e329025a5a43e258ce7ccf9acad236893be25fda26054ec8d4e72c910e1797c5beee8b13112323294ffa83d050f6bafad53db3173df4ff034aa325dce67561d1fa35086bd62744d068b78d45e0eb852cc8a15d614474160e5958aed2b5eea5bcd6d7076ab62978fd976767dd8d4f17944fd2ed0caf972437c3a29c81da6be143b6577b4cecbf791319e79fe844e94781b75e701e91f83dd17b27f50b7056434805dda92fab86101d0b12e31ad04c6e75ded645b30b748887935c564a41029af7aeb799d8b67f88fa11f2457cf4d71b91c01cf1a0fbd4080a411a142acef4eb34486e66879ed54b7a397fbb0e3d3861cf735706e412066bd96b5308cd7018c22d4f974691bca9f0
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
    - Subject: ??=Private Organization, serialNumber=HRB 6186, ??=DE, ??=Bayern, ??=Kempten
        (Allgaeu), C=DE, ST=Bayern, L=Kempten (Allg??u), ??=Memminger Str. 151, O=3S,Smart
        Software Solutions GmbH, CN=3S,Smart Software Solutions GmbH, emailAddress=info@codesys.com
      ValidFrom: '2019-02-01 15:34:02'
      ValidTo: '2021-02-01 15:34:02'
      Signature: 80dad6d1dcb4d50486f485a5309cfafec484503d27a24a02d63b1343782a476cf76e64e32c7dfc9aca28cbdcc636c4ce4da1da4dd72f613fa54c68489ee8331b4fc66399ea933533a946e4f30f64f2ee09d592c06d1482c128e6d2c8cf0b5321a919bece3e8338c86717291eb589575bd3780e66a24111a1fa3975ffd0df0e779cf4a3ec9ecb06a7a6d89e6467d9104742fe3be7af25d1adf7e3583159a852d82e64b7b4c5f9134dbab58e4d736204e1bfdf0a66121fd9cb0a674ffac58e4de9019444329e5dd5d81770c24fc4529c52f527f473cd2ecb27b97e68b2486db25f8c2c4ced516f0c18cf1cb4b36d09109d88d20ba6b5259f4b6405c5d268718a97
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
    Signer:
    - SerialNumber: 60a8b030535055def1677cc6
      Issuer: C=BE, O=GlobalSign nv,sa, CN=GlobalSign Extended Validation CodeSigning
        CA , SHA256 , G3
Tags:
- SysDrv3S.sys
