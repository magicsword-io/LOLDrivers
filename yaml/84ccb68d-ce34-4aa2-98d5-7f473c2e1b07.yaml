Id: 84ccb68d-ce34-4aa2-98d5-7f473c2e1b07
Tags:
- SysInfo.sys
Verified: 'TRUE'
Author: Michael Haag
Created: '2023-01-09'
MitreID: T1068
Category: vulnerable driver
Commands:
  Command: sc.exe create SysInfo.sys binPath=C:\windows\temp\SysInfo.sys type=kernel
    && sc.exe start SysInfo.sys
  Description: ''
  OperatingSystem: Windows 10
  Privileges: kernel
  Usecase: Elevate privileges
Resources:
- https://github.com/namazso/physmem_drivers
Detection: []
Acknowledgement:
  Handle: ''
  Person: ''
KnownVulnerableSamples:
- Authentihash:
    MD5: 0f56e9fddae9389425d93099ad609867
    SHA1: ca88f321631c1552e3e0bcd1f26ad3435cc9f1ae
    SHA256: a82d08ef67bdfccf0a2cf6d507c9fbb6ac42bd74bf2ade46ec07fe253deb6573
  Company: ''
  Copyright: ''
  CreationTimestamp: '2005-09-18 17:24:12'
  Date: ''
  Description: ''
  ExportedFunctions: ''
  FileVersion: ''
  Filename: SysInfo.sys
  ImportedFunctions:
  - RtlInitUnicodeString
  - __C_specific_handler
  - MmUnmapIoSpace
  - MmMapIoSpace
  - IoDisconnectInterrupt
  - IoConnectInterrupt
  - IoCreateDevice
  - KeInsertQueueDpc
  - ZwClose
  - IoDeleteSymbolicLink
  - IofCompleteRequest
  - KeInitializeDpc
  - IoCreateSymbolicLink
  - KeClearEvent
  - IoDeleteDevice
  - HalGetBusDataByOffset
  - HalSetBusDataByOffset
  Imports:
  - ntoskrnl.exe
  - HAL.dll
  InternalName: ''
  MD5: 5228b7a738dc90a06ae4f4a7412cb1e9
  MachineType: AMD64
  MagicHeader: 50 45 0 0
  OriginalFilename: ''
  Product: ''
  ProductVersion: ''
  Publisher: ''
  RichPEHeaderHash:
    MD5: 6f1cb980913392475dc6ef6c3e569966
    SHA1: f9a5cfdfccc186ff84aa40a07c1cdb730d82e085
    SHA256: bad3eabf9d630efa497af8ca6a682b596241143a6ce77f4e267cf15e19895da9
  SHA1: f0c463d29a5914b01e4607889094f1b7d95e7aaf
  SHA256: 7049f3c939efe76a5556c2a2c04386db51daf61d56b679f4868bb0983c996ebb
  Sections:
    .text:
      Entropy: 5.870227791947925
      Virtual Size: '0x14fe'
    .rdata:
      Entropy: 4.287500138971227
      Virtual Size: '0x3d0'
    .data:
      Entropy: 1.2323958376791513
      Virtual Size: '0x194'
    .pdata:
      Entropy: 3.8940062848117547
      Virtual Size: '0x1e0'
    INIT:
      Entropy: 4.784186682731765
      Virtual Size: '0x2b0'
    .reloc:
      Entropy: 2.011866957009745
      Virtual Size: '0x5c'
  Signature:
  - Noriyuki MIYAZAKI
  - GlobalSign ObjectSign CA
  - GlobalSign Primary Object Publishing CA
  - GlobalSign Root CA - R1
  Signatures:
  - CertificatesInfo: ''
    SignerInfo: ''
    Certificates:
    - Subject: C=JP, CN=Noriyuki MIYAZAKI, emailAddress=hiyohiyo@crystalmark.info
      ValidFrom: '2007-09-24 10:50:55'
      ValidTo: '2008-09-24 10:50:55'
      Signature: 4b6c4ea808b550cbae0f97c27726a0445d0e3e021ee0e0087bfe5bbc290e3e45ca35333f2a97fb7667f64326629f7a99fe2fec4da9fe14f0d858419982b983457848fbd6a9115769db6c5626b4d2f87fc77019a755a9efdf81b1968dfbfa638bf87bd25a8adf1c6c3bba3735f06b54d127462ed40dc364ad4c4f29c9f9692b29ff9557300a7c0d395f250172e312ff253b7ce8885ef8c1fe60c448676180e4ca09b34b52ae116b01f22b446b827a748ca80aee5f8e9ff6725e1dce5a7984c26eb72a615a9ef272f6f7b2e03e6d34665caf506b93cb5a2de127177eb1923cf5bc499e312d6c43ff5a26124ea63a4dc9a3340daa6449c2322857adf98166423cfb
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 01000000000115372421a8
      Version: 3
      CertificateType: Intermediate
      IsCodeSigning: false
      IsCA: false
      TBS:
        MD5: c11203d7c1fcb38e1eaff246bb8e7595
        SHA1: 99f00de6eefb2076662465e682a2429373ebcb26
        SHA256: 08a073aa77d42d608a9457a6b1d63eadcf5113407d8a55025ea1bbef0716dca5
        SHA384: ef57f44999a39185b9ebf97894ce5a3cca2894e15bc0733a865501c3a41ea9054be5d7517aa59006b04a853cadbed567
    - Subject: CN=GlobalSign RootSign Partners CA, OU=RootSign Partners CA, O=GlobalSign
        nv,sa, C=BE
      ValidFrom: '2003-12-16 13:00:00'
      ValidTo: '2014-01-27 11:00:00'
      Signature: 5c2f2e674a26b3e7b53f353cdda003ed569af9443752163065c7d14ea20f8db7b6b6678ee74cec8d95bee6cea7227874acd7f87499b3f7ce8b1338d596cc8d76c52f38b23aae61be0b8799e321626423398d84f6858df777ffb03806f07ec1485fb5ee582606660522749283a7dbb5f992e3e8c3192c2e63efbb1fdff9f70747660d0789977ef8332c9ecbae143df11cdfa3f179afc8928f9471c4d144c554db1eb50b0aa942a3afd643391dee8f9398585bbe6e9c0bf563ec5e99c2f954fa010746da0db06424cf8ed1061d4f3ca26377455ba4bc5fb080bb31e00b54015c161d724ed52a6947d11b667e5f016ef135916be02efeb045d81627b5c58bc2da53
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 040000000000f97faa2e1e
      Version: 3
      CertificateType: CA
      IsCodeSigning: false
      IsCA: true
      TBS:
        MD5: 59466cb0c1788b2f251fce3495837102
        SHA1: c5cfc5f6a131a3a77c3905c9893c99bb1b2baa0b
        SHA256: eedda02668f7636eeec69429a7164cc47ca3de0539122d37f5b8078df7ee56db
        SHA384: 982b72c3ee7066ce80ee642444c91adc60e7009fc6ef981a32edf666591d6aedb09d258e10e86f4ef265eae8149bbd92
    - Subject: C=BE, O=GlobalSign nv,sa, OU=Primary Object Publishing CA, CN=GlobalSign
        Primary Object Publishing CA
      ValidFrom: '1999-01-28 12:00:00'
      ValidTo: '2014-01-27 11:00:00'
      Signature: a0422eb876a7427186404d464d5b26b0b074f93f89a87b7cb7f1c697e08239999d43fe60823642b55b878df55df4bbffa91044a871d3c7f12241f29aa4a5ec63fae5eb654a19309d8bc7b6fddc3fe16cfdd5521407fc6d24ccb3cc81a2c052f327b96d9e063dd8a849023269c7054294d0bbe3bba908c393501bdb846dc0ba1e5298659c1376bdb3d567292f1f7baa2c51a0fd854f263c48a38127a6feee7f7899c245cf9d1f527ed7958bfde1d020c3af7e51a22f663bab2dcf2d8e8c4d7d18392128fbdcae6d6581d0e0d7184be7b5f774d784e6522aac3b68fd3b4ab80154849132bb95d28e6330a69ece2396feab2eb86a8b74dcde21a114c2fbbf53af10
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 04000000000108d9611cd6
      Version: 3
      CertificateType: CA
      IsCodeSigning: false
      IsCA: true
      TBS:
        MD5: 698f075151097d84c0b1f3e7bc3d6fca
        SHA1: 041750993d7c9e063f02dfe74699598640911aab
        SHA256: a8622cca0913a20477be8313b8d16fcad5d83088b46b36ddac10b31e96abb5e8
        SHA384: a50291d3b15caf28d96e972cefcb88455a58ce1c802920fdcc2f4feafb1553510fd9b464d25e81635f4ad37570225a67
    - Subject: O=GlobalSign, CN=GlobalSign Time Stamping Authority, emailAddress=timestampinfo@globalsign.com
      ValidFrom: '2007-02-05 09:00:00'
      ValidTo: '2014-01-27 09:00:00'
      Signature: 649b07caaccc411e37ef6f349cb5e8ca48f9daeafaf7172e5cad193b7311ec5adbfd7b213161c092515bb166b07c64d8fe10b471a8bc9e75379c5f6ff2da0437b8ecc003e256b7785995581d7a7c3e18d74c32bdf91ee723457fdee08d65825b45fd64c66fc3d7ea12411d0c395ef696f8c3cd9e1fff51886976988b8eb42788821ad63c7aabb04eb73ee8d434d2c1a439533cb2747b15373054a6ebb924cc2f084b4364f14aaf8d9ce8546cb2dbdc3bb1c722849f558e72a8b2a8f6f0ff03c996ebab8273dabe45561936fdba6cbc71f0d3c7c376d7e4bce2a1a67200cfbdb200ed92aa39ab09d16e3953862ad43b517398b754e9972d9977ee123e3642257f
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 0400000000011092eb8295
      Version: 3
      CertificateType: Intermediate
      IsCodeSigning: false
      IsCA: false
      TBS:
        MD5: 11d73a3638fc78e0bac6c459feadcc42
        SHA1: 6636f7dcf81b370b919966f9063295ec84422f91
        SHA256: 1eb5fc1d2e3254b1e3c4587a6efed87ee65306525e684b4cfa4b51893cfe86a3
        SHA384: a13c07e505c79c58654ad2cffe219c6c801fa092c52f18c489a6061420c6475706f11c200f4dadd51718c660e49b3f24
    - Subject: C=BE, O=GlobalSign nv,sa, OU=ObjectSign CA, CN=GlobalSign ObjectSign
        CA
      ValidFrom: '2004-01-22 09:00:00'
      ValidTo: '2014-01-27 10:00:00'
      Signature: 11d45d8af43d0d9d7e4fa70071610b56b34caa70e1b2d1dec7886d1d897c2ba946e58b1f8e4cc26695911fe34d394ae31b70b7446edc068a4d6d25e89812dcbca0dd864eae8f81130540905a542529944acaf165b4ef0679dae7cb86f004c918dcee72b320015748dfe333e12ccd9c077f9447278d888d340ca67c5c20c17d07b3736b648c26d29bd7e87965a6a891a174862a050282c1847cf279cd3c2a2b0f99291eea8c8a1ab16aeaa266380e65e1add8c6c91f888d3976ee1782c4138d97ce6341e77af5b4b66c15c33813b3930b620688dde1447f10a950248b60dc05f75ba514b27b56720b96eabffc057090659e051ca4dd07af4b57dec639673bc574
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 04000000000108d9612448
      Version: 3
      CertificateType: CA
      IsCodeSigning: false
      IsCA: true
      TBS:
        MD5: 2fc76031fc24eec1ef3db2d246d21d6a
        SHA1: 75c3a1f76b9dfa31ef6bf56325e7bd0bf6e4779d
        SHA256: 9238292d441c56dc89684c253343c17de3ed9cecd7f83d1d8f793b5ebc91f7b9
        SHA384: 9279c1377eb701fdd79ef85038ff151cd8902169ba55fca84b9850f003563f73a1daaf869544252a2e42f06f58d2275f
    - Subject: C=BE, O=GlobalSign nv,sa, OU=Root CA, CN=GlobalSign Root CA
      ValidFrom: '2006-05-23 17:00:51'
      ValidTo: '2016-05-23 17:10:51'
      Signature: 13c56c5e077f3c57ff9b315f3fbd955425c679f92c31034d64694b56d95b976f7cf3f0d024657538639813701613f7a701f1c623e085866c0bf080945a75e87ce41e92b473bfc1b3a7b00bd31884cbcc09a35c9c4f3eb03a9c2d1bc404ef9737966fe5ecbaac6ab3d4e23cdf8b25e7acbc624531dda40a72e41bf8784301ccba3914de5d90aed85acf5eca46815133d5a60e5867d3d8665888169beeb11acaad91138421da9a6e20efda007428bac95ff34d5dc3da25692554ea44bcc39b29331cd63c961f8781c553d72a2733d42e197c08586ddb4e1999a9ea5ff39a9d8c513a5a5cbd2fa908359b54a7db351a521633343aa380046afdb4838cad90cf0c3a6596ec334e1826b849bbeb8192ff134d324b23c733e7b6716b15f69c80e6bcb76cbe41d5033a7133150050743b0e5df996aaed903eab134c809926bc38a5eb0236891db620be83ab10f8199ed76379d4aeb12f6136f94a4ba833c70e7241f9f1b1907eae46efde397b75a0411459041d42bc4788b8130e05fa1df0808dff70c677d84bdc460e231a72d5bfdefeaaae69583cfc5c46e4d5819a8b6e6559771a32a590a6b6649364fd0753c9a0de28ad2a6cc638d181ce98f54019e92c1743a4265fd3443053e41d02baa40a2f16dd7a60275242bbad98372897e4b8d27911e3108c48d5305d0a0c52def588ea8d1a2d67c9f4801484b7850cd16628a5c66f2461
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 610b7f6b000000000019
      Version: 3
      CertificateType: Intermediate
      IsCodeSigning: false
      IsCA: false
      TBS:
        MD5: 4798d55be7663a75649cda4dedc686ef
        SHA1: 0f1ab2937b245d9466ea6f9bf056a5942e3989cf
        SHA256: ef14ea05bb066ee9f4188196dd69cd769b283ac4d7555db52f5e76922d3456e1
        SHA384: 6e7450a139856aeda6fa6284ff89b3752a9b646e096b4d33dd7e8e727742a2111481531581c0aa2cda0338e22cfdbad3
    Signer:
    - SerialNumber: 01000000000115372421a8
      Issuer: C=BE, O=GlobalSign nv,sa, OU=ObjectSign CA, CN=GlobalSign ObjectSign
        CA
      Version: 1
  Imphash: 3c61f9a38aaa7650fcd33b46e794d1bb
  LoadsDespiteHVCI: 'FALSE'
