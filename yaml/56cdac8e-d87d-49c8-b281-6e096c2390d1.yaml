Id: 56cdac8e-d87d-49c8-b281-6e096c2390d1
Tags:
- gvcidrv64.sys
Verified: 'TRUE'
Author: Nasreddine Bencherchali
Created: '2023-05-06'
MitreID: T1068
Category: vulnerable driver
Commands:
  Command: sc.exe create gvcidrv64.sys binPath=C:\windows\temp\gvcidrv64.sys type=kernel
    && sc.exe start gvcidrv64.sys
  Description: ''
  Usecase: Elevate privileges
  Privileges: kernel
  OperatingSystem: Windows 10
Resources:
- Internal Research
Detection: []
Acknowledgement:
  Person: ''
  Handle: ''
KnownVulnerableSamples:
- Filename: gvcidrv64.sys
  MD5: 1a22a85489a94db6ff68cd624ef43bad
  SHA1: d302ae7f016299af323a3542d840004888ab91ff
  SHA256: a2353030d4ea3ad9e874a0f7ff35bbfa10562c98c949d88cabab27102bbb8e48
  Authentihash:
    MD5: ad8e307b0233a1b6548414390c31f9af
    SHA1: 4a04ad93f7f4dccca551dc0fea7b9b22f557e39b
    SHA256: dc8a1cf5402f95d61662531507b12b04e16922eb89108eb751d1c634d475ef67
  Description: ''
  Company: ''
  InternalName: ''
  OriginalFilename: ''
  FileVersion: ''
  Product: ''
  ProductVersion: ''
  Copyright: ''
  MachineType: AMD64
  Imports:
  - ntoskrnl.exe
  - HAL.dll
  - WDFLDR.SYS
  ExportedFunctions: ''
  ImportedFunctions:
  - IoDeleteDevice
  - IoDeleteSymbolicLink
  - ObReferenceObjectByHandle
  - IoCreateSymbolicLink
  - ZwOpenSection
  - ZwMapViewOfSection
  - ZwUnmapViewOfSection
  - IoCreateDevice
  - IofCompleteRequest
  - RtlCopyUnicodeString
  - DbgPrint
  - ZwClose
  - RtlInitUnicodeString
  - HalTranslateBusAddress
  - WdfVersionUnbind
  - WdfVersionBind
  - WdfVersionUnbindClass
  - WdfVersionBindClass
  Signatures:
  - CertificatesInfo: ''
    SignerInfo: ''
    Certificates:
    - Subject: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Hardware Compatibility Publisher
      ValidFrom: '2019-06-05 18:34:00'
      ValidTo: '2020-06-03 18:34:00'
      Signature: 312314217055afc1a5751181c7d2d7619b23ba17166e6ae6f358b16921c925c6e3b75c31b93035f357c154fe4d347019e927db1957193b741e3371b46f4d6212b3bec972d6ff2297e8b1f2391f840045471ee31c524d4f5bf1cae4a32b73f6e48f51f777bb5b8a726db2a387c7c8df42289540f4f3d27b37d4ab4854efba809021879f3257d5670d70003a51d62bbc68e345a769f37ccb3ad336b7b3c494f5d56ef8300228d29835e5129b070742a220f83b6c9d5e2589cf2e7a1f7b59cfc81cda3232fc2fa448d736db546dc4b274cad3da83433deaa3eb9919b23ad08dc4055a8026711adcfccdb47d7a7c1adb2671ecc7198a786973807699a0ee236a46771f88913b769693b0b8ce9b002a40c2aa426edfd9a98368f89817b0d174458a390e11628e21f77e751431fae13831228e0e357610a24d89806d85390e9b3831792f62688bf04f91ee9a854b252452de7e752f39e57765a09a4ff41ae96144593a8a99688c6c9ad6b9fcaba1189ef2372b99e96db3fe6402b0e125b17f36c6f70fc1eb83257ce639b6c691a9ec031dddb9fa6536bb8e6080c9db976533f4ddfb73309b6498543cc94d3283d43668d614dd60a4fe707eb3b871da3204c534c8cc73cbc66aeb36cefd765439eef68d7ee9c515eb617f051a72097d0a25003df2dceccc9a0c4be1fd27e473955cc83ee9dba626748b1cb723c3b1c8b8ebc59321a0f5
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      IsCertificateAuthority: false
      SerialNumber: 33000000319479a318f5522d06000000000031
      Version: 3
      CertificateType: Leaf (Code Signing)
      IsCodeSigning: true
      IsCA: false
      TBS:
        MD5: 5b81fd0f706522a8d7c9f2957283c0b4
        SHA1: 84d894599653a8ed0e0b2802db3197dc177908cc
        SHA256: 4fa629304df4287c97ae5b7e481974316e9daf776b0cdeffab1671e7dca68fb4
        SHA384: 0b89dc122fc7ebf80881a5047ffbbcb0bec30636516aff4f43307e2a925a476cabfc26e2cc392ad748d655f6ec4c8b75
    - Subject: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Third Party Component CA 2014
      ValidFrom: '2014-10-15 20:31:27'
      ValidTo: '2029-10-15 20:41:27'
      Signature: 96b5c33b31f27b6ba11f59dd742c3764b1bca093f9f33347e9f95df21d89f4579ee33f10a3595018053b142941b6a70e5b81a2ccbd8442c1c4bed184c2c4bd0c8c47bcbd8886fb5a0896ae2c2fdfbf9366a32b20ca848a6945273f732332936a23e9fffdd918edceffbd6b41738d579cf8b46d499805e6a335a9f07e6e86c06ba8086725afc0998cdba7064d4093188ba959e69914b912178144ac57c3ae8eae947bcb3b8edd7ab4715bba2bc3c7d085234b371277a54a2f7f1ab763b94459ed9230cce47c099212111f52f51e0291a4d7d7e58f8047ff189b7fd19c0671dcf376197790d52a0fbc6c12c4c50c2066f50e2f5093d8cafb7fe556ed09d8a753b1c72a6978dcf05fe74b20b6af63b5e1b15c804e9c7aa91d4df72846782106954d32dd6042e4b61ac4f24636de357302c1b5e55fb92b59457a9243d7c4e963dd368f76c728caa8441be8321a66cde5485c4a0a602b469206609698dcd933d721777f886dac4772daa2466eab64682bd24e98fb35cc7fec3f136d11e5db77edc1c37e1f6a4a14f8b4a721c671866770cdd819a35d1fa09b9a7cc55d4d728e74077fa74d00fcdd682412772a557527cda92c1d8e7c19ee692c9f7425338208db38cc7cc74f6c3a6bc237117872fe55596460333e2edfc42de72cd7fb0a82256fb8d70c84a5e1c4746e2a95329ea0fecdb4188fd33bad32b2b19ab86d0543fbff0d0f
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      IsCertificateAuthority: true
      SerialNumber: 330000000d690d5d7893d076df00000000000d
      Version: 3
      CertificateType: CA
      IsCodeSigning: false
      IsCA: true
      TBS:
        MD5: 83f69422963f11c3c340b81712eef319
        SHA1: 0c5e5f24590b53bc291e28583acb78e5adc95601
        SHA256: d8be9e4d9074088ef818bc6f6fb64955e90378b2754155126feebbbd969cf0ae
        SHA384: 260ad59ba706420f68ba212931153bd89f760c464b21be55fba9d014fff322407859d4ebfb78ea9a3330f60dc9821a63
    Signer:
    - SerialNumber: 33000000319479a318f5522d06000000000031
      Issuer: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft
        Windows Third Party Component CA 2014
      Version: 1
  RichPEHeaderHash:
    MD5: 5989194a389d2f7302b66de35c6b4ff5
    SHA1: bcd3bbaf6c808eb23b0cad3cef6586bfcd063d62
    SHA256: 83dbcc75fa740bdc3df5599b038ff6386a6a58805acfdaa77173f37b1808c012
  Sections:
    .text:
      Entropy: 6.147035799967813
      Virtual Size: '0xe0b'
    .rdata:
      Entropy: 3.8004281893864085
      Virtual Size: '0x54c'
    .data:
      Entropy: 0.5982968479127164
      Virtual Size: '0xf28'
    .pdata:
      Entropy: 3.4469659354420483
      Virtual Size: '0xb4'
    INIT:
      Entropy: 4.9556661025850675
      Virtual Size: '0x2fa'
    .reloc:
      Entropy: 3.0890191852411095
      Virtual Size: '0x24'
  MagicHeader: 50 45 0 0
  CreationTimestamp: '2019-12-06 04:42:17'
  Imphash: ad374977f06fefefbb9c77155f7a0733
  LoadsDespiteHVCI: 'FALSE'
- Filename: GVCIDrv64.sys
  MD5: acd221ff7cf10b6117fd609929cde395
  SHA1: 1586f121d38cc42e5d04fe2f56091e91c6cdd8fa
  SHA256: f85784fa8e7a7ec86cb3fe76435802f6bb82256e1824ed7b5d61bf075f054573
  Authentihash:
    MD5: ad8e307b0233a1b6548414390c31f9af
    SHA1: 4a04ad93f7f4dccca551dc0fea7b9b22f557e39b
    SHA256: dc8a1cf5402f95d61662531507b12b04e16922eb89108eb751d1c634d475ef67
  Description: ''
  Company: ''
  InternalName: ''
  OriginalFilename: ''
  FileVersion: ''
  Product: ''
  ProductVersion: ''
  Copyright: ''
  MachineType: AMD64
  Imports:
  - ntoskrnl.exe
  - HAL.dll
  - WDFLDR.SYS
  ExportedFunctions: ''
  ImportedFunctions:
  - IoDeleteDevice
  - IoDeleteSymbolicLink
  - ObReferenceObjectByHandle
  - IoCreateSymbolicLink
  - ZwOpenSection
  - ZwMapViewOfSection
  - ZwUnmapViewOfSection
  - IoCreateDevice
  - IofCompleteRequest
  - RtlCopyUnicodeString
  - DbgPrint
  - ZwClose
  - RtlInitUnicodeString
  - HalTranslateBusAddress
  - WdfVersionUnbind
  - WdfVersionBind
  - WdfVersionUnbindClass
  - WdfVersionBindClass
  Signatures:
  - CertificatesInfo: ''
    SignerInfo: ''
    Certificates:
    - Subject: C=US, O=Symantec Corporation, CN=Symantec Time Stamping Services CA
        , G2
      ValidFrom: '2012-12-21 00:00:00'
      ValidTo: '2020-12-30 23:59:59'
      Signature: 03099b8f79ef7f5930aaef68b5fae3091dbb4f82065d375fa6529f168dea1c9209446ef56deb587c30e8f9698d23730b126f47a9ae3911f82ab19bb01ac38eeb599600adce0c4db2d031a6085c2a7afce27a1d574ca86518e979406225966ec7c7376a8321088e41eaddd9573f1d7749872a16065ea6386a2212a35119837eb6
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 7e93ebfb7cc64e59ea4b9a77d406fc3b
      Version: 3
      CertificateType: CA
      IsCodeSigning: false
      IsCA: true
      TBS:
        MD5: d0785ad36e427c92b19f6826ab1e8020
        SHA1: 365b7a9c21bd9373e49052c3e7b3e4646ddd4d43
        SHA256: c2abb7484da91a658548de089d52436175fdb760a1387d225611dc0613a1e2ff
        SHA384: eab4fe5ef90e0de4a6aa3a27769a5e879f588df5e4785aa4104debd1f81e19ea56d33e3a16e5facf99f68b5d8e3d287b
    - Subject: C=US, O=Symantec Corporation, CN=Symantec Time Stamping Services Signer
        , G4
      ValidFrom: '2012-10-18 00:00:00'
      ValidTo: '2020-12-29 23:59:59'
      Signature: 783bb4912a004cf08f62303778a38427076f18b2de25dca0d49403aa864e259f9a40031cddcee379cb216806dab632b46dbff42c266333e449646d0de6c3670ef705a4356c7c8916c6e9b2dfb2e9dd20c6710fcd9574dcb65cdebd371f4378e678b5cd280420a3aaf14bc48829910e80d111fcdd5c766e4f5e0e4546416e0db0ea389ab13ada097110fc1c79b4807bac69f4fd9cb60c162bf17f5b093d9b5be216ca13816d002e380da8298f2ce1b2f45aa901af159c2c2f491bdb22bbc3fe789451c386b182885df03db451a179332b2e7bb9dc20091371eb6a195bcfe8a530572c89493fb9cf7fc9bf3e226863539abd6974acc51d3c7f92e0c3bc1cd80475
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: false
      SerialNumber: 0ecff438c8febf356e04d86a981b1a50
      Version: 3
      CertificateType: Intermediate
      IsCodeSigning: false
      IsCA: false
      TBS:
        MD5: e9d38360b914c8863f6cba3ee58764d3
        SHA1: 4cba8eae47b6bf76f20b3504b98b8f062694a89b
        SHA256: 88901d86a4cc1f1bb193d08e1fb63d27452e63f83e228c657ab1a92e4ade3976
        SHA384: e9f2a75334a9e336c5a4712eadee88d0374b0fdc273262f4e65c9040ad2793067cc076696db5279a478773485e285652
    - Subject: C=US, O=Symantec Corporation, OU=Symantec Trust Network, CN=Symantec
        Class 3 Extended Validation Code Signing CA , G2
      ValidFrom: '2014-03-04 00:00:00'
      ValidTo: '2024-03-03 23:59:59'
      Signature: 3f5b19f3fa13d575382a5aee9f5aa04ca91dc5cc94eede15fef5106ea41ba56483541858c40b28a185c34e74e5ff897cfed5ed3cba719f5602268f162a88feb0a32722ce4be2388e00a63a865f9de53ea8de644941744121fd07c88417da1d653082cb264f39d60427a481b14b49c3238b7e02321827b7ab0bf31872b6a4ee67066f38a6588de0f17e5da460c6a8e5505fe0e8bae28f9958b6b5a0a876f1a2f11c8841727e52979b0a36998d50f701eb3ce7f0226ae5358c63368a1ab1d967665f971aefa8209df02fba6cced9948500f158f17dc97c22b5075d02c6e60bbfab9393ff27188e33367e5734f1c3af04c184f156b3e8878336f8d30a31dc6e2c6d
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      IsCertificateAuthority: true
      SerialNumber: 191a32cb759c97b8cfac118dd5127f49
      Version: 3
      CertificateType: CA
      IsCodeSigning: true
      IsCA: true
      TBS:
        MD5: 788b61bd26da89253179e3de2cdb527f
        SHA1: 7d06f16e7bf21bce4f71c2cb7a3e74351451bf69
        SHA256: b3c925b4048c3f7c444d248a2b101186b57cba39596eb5dce0e17a4ee4b32f19
        SHA384: 2955e28cb7ec0ea9730b499a0f189f9621eceb02591a9486b583f12bb845885a30d6a871826318a167cc5f06b274e58c
    - Subject: ??=TW, ??=, ??=NEW TAIPEI, ??=Private Organization, serialNumber=22044755,
        C=TW, L=NEW TAIPEI, O=GIGA,BYTE Technology Co., Ltd., CN=GIGA,BYTE Technology
        Co., Ltd.
      ValidFrom: '2018-12-07 00:00:00'
      ValidTo: '2021-12-06 23:59:59'
      Signature: 502fd3341b71cab45e302c7b586f9beefdce61639b7ccbaf643eb13bb29fcc6d5e37ba8f8af0b2d775216237d659088cbf124514ebe1fc6a663f20cbbd920afd64fbec463254a4e845cdb452b5768fcb2fb74e13043899381b57ce63419679395729d52fc8efbe19e08c5a4c6337eb910e048d30c2888718355460150ae33f20c8ea3724251dbe28d45de130843b462e11ff1ca90fb98e097b5f372b0aa1c5b2791897b4cf79cdbc02c5aca5a935a3ccf67fb67ef28390ed7913ee32e708869acbba27f24d6c7fc45b795b5e90c7200551babe0bae400343fc6fd75d36da7b5def7fde3a7f97519796d3bd14755a3adaa7cafcbe2cc24eb9a1a046ea8e05376d
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      IsCertificateAuthority: false
      SerialNumber: 4f8eefa0dcc85bbd656ab0f160743d34
      Version: 3
      CertificateType: Leaf (Code Signing)
      IsCodeSigning: true
      IsCA: false
      TBS:
        MD5: 5415ec7433f8ae320658011dfcfa2998
        SHA1: 044407fe1b8e4b5af9eecf34ea87a0ecb32ee6bb
        SHA256: f828f449f9b365a1455b8358b044385beaf097166a80defc440eacb8deb6ef26
        SHA384: 640b5b53eabd60a97be0f1fcf7c893edb3d8ebf507c63958114532cd445246dc0ae92a4dadec314dd5babee5d7f0497c
    Signer:
    - SerialNumber: 4f8eefa0dcc85bbd656ab0f160743d34
      Issuer: C=US, O=Symantec Corporation, OU=Symantec Trust Network, CN=Symantec
        Class 3 Extended Validation Code Signing CA , G2
      Version: 1
  RichPEHeaderHash:
    MD5: 5989194a389d2f7302b66de35c6b4ff5
    SHA1: bcd3bbaf6c808eb23b0cad3cef6586bfcd063d62
    SHA256: 83dbcc75fa740bdc3df5599b038ff6386a6a58805acfdaa77173f37b1808c012
  Sections:
    .text:
      Entropy: 6.147035799967813
      Virtual Size: '0xe0b'
    .rdata:
      Entropy: 3.8004281893864085
      Virtual Size: '0x54c'
    .data:
      Entropy: 0.5982968479127164
      Virtual Size: '0xf28'
    .pdata:
      Entropy: 3.4469659354420483
      Virtual Size: '0xb4'
    INIT:
      Entropy: 4.9556661025850675
      Virtual Size: '0x2fa'
    .reloc:
      Entropy: 3.0890191852411095
      Virtual Size: '0x24'
  MagicHeader: 50 45 0 0
  CreationTimestamp: '2019-12-06 04:42:17'
  Imphash: ad374977f06fefefbb9c77155f7a0733
  LoadsDespiteHVCI: 'TRUE'
