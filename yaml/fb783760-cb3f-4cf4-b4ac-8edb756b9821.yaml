Id: fb783760-cb3f-4cf4-b4ac-8edb756b9821
Tags:
- atlAccess.sys
Verified: 'TRUE'
Author: Takahiro Haruyama
Created: '2023-11-02'
MitreID: T1068
Category: vulnerable driver
Commands:
  Command: sc.exe create atlAccesssys binPath= C:\windows\temp\atlAccesssys.sys type=kernel
    && sc.exe start atlAccesssys
  Description: The Carbon Black Threat Analysis Unit (TAU) discovered 34 unique vulnerable
    drivers (237 file hashes) accepting firmware access. Six allow kernel memory access.
    All give full control of the devices to non-admin users. By exploiting the vulnerable
    drivers, an attacker without the system privilege may erase/alter firmware, and/or
    elevate privileges. As of the time of writing in October 2023, the filenames of
    the vulnerable drivers have not been made public until now.
  OperatingSystem: Windows 10
  Privileges: kernel
  Usecase: Elevate privileges
Resources:
- https://blogs.vmware.com/security/2023/10/hunting-vulnerable-kernel-drivers.html
Detection: []
Acknowledgement:
  Handle: ''
  Person: ''
KnownVulnerableSamples:
- Company: Windows (R) Win 7 DDK provider
  Date: ''
  Description: Simple PCI access driver
  FileVersion: '6.1.7600.16385 built by: WinDDK'
  Filename: ''
  MD5: 08001b0cdb0946433366032827d7a187
  MachineType: AMD64
  OriginalFilename: atlAccess.sys
  Product: Windows (R) Win 7 DDK driver
  ProductVersion: 6.1.7600.16385
  Publisher: ''
  SHA1: 6b54b8f7edca5fb25a8ef1a1d31e14b9738db579
  SHA256: 0b57569aaa0f4789d9642dd2189b0a82466b80ad32ff35f88127210ed105fe57
  Signature: ''
  Imphash: 8b47d6faba90b5c89e27f7119c987e1a
  Authentihash:
    MD5: b9bac046427a6f1664a5af4baebd3a61
    SHA1: c5d83d40db80c87b370af91c67713658c6ae0a79
    SHA256: c25cb17f5879e9c2fb4c91adb18e24b50a94738d5deb62a4189065bcf2c1d86b
  RichPEHeaderHash:
    MD5: ae583efa641b5b3adcd20b1b1f8a468c
    SHA1: 26b53309451f6cb17ebcd2e6adaf2ff420605f24
    SHA256: e5fc90cce8f3fbf1937764ed5b2b36b9d7346be931e177172ef52aaa225183f6
  Sections:
    .text:
      Entropy: 5.315744591990343
      Virtual Size: '0xc24'
    .rdata:
      Entropy: 3.9728170876693523
      Virtual Size: '0x168'
    .data:
      Entropy: 0.4975521352521052
      Virtual Size: '0x11c'
    .pdata:
      Entropy: 3.294395845770031
      Virtual Size: '0x84'
    INIT:
      Entropy: 5.075371650679493
      Virtual Size: '0x2bc'
    .rsrc:
      Entropy: 3.4471340230661465
      Virtual Size: '0x3f8'
  MagicHeader: 50 45 0 0
  CreationTimestamp: '2020-03-31 03:35:36'
  InternalName: atlAccess.sys
  Copyright: "\xA9 Microsoft Corporation. All rights reserved."
  Imports:
  - ntoskrnl.exe
  ExportedFunctions: ''
  ImportedFunctions:
  - MmUnmapLockedPages
  - ExAllocatePoolWithTag
  - IoDeleteSymbolicLink
  - ExFreePoolWithTag
  - RtlInitUnicodeString
  - IoDeleteDevice
  - MmUnmapIoSpace
  - MmBuildMdlForNonPagedPool
  - IoFreeMdl
  - MmMapLockedPagesSpecifyCache
  - MmMapIoSpace
  - IofCompleteRequest
  - IoCreateSymbolicLink
  - IoCreateDevice
  - RtlAssert
  - DbgPrint
  - IoAllocateMdl
  - KeBugCheckEx
  Signatures:
  - CertificatesInfo: ''
    SignerInfo: ''
    Certificates:
    - Subject: C=US, O=Symantec Corporation, CN=Symantec Time Stamping Services CA
        , G2
      ValidFrom: '2012-12-21 00:00:00'
      ValidTo: '2020-12-30 23:59:59'
      Signature: 03099b8f79ef7f5930aaef68b5fae3091dbb4f82065d375fa6529f168dea1c9209446ef56deb587c30e8f9698d23730b126f47a9ae3911f82ab19bb01ac38eeb599600adce0c4db2d031a6085c2a7afce27a1d574ca86518e979406225966ec7c7376a8321088e41eaddd9573f1d7749872a16065ea6386a2212a35119837eb6
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 7e93ebfb7cc64e59ea4b9a77d406fc3b
      Version: 3
      CertificateType: CA
      IsCodeSigning: false
      IsCA: true
      TBS:
        MD5: d0785ad36e427c92b19f6826ab1e8020
        SHA1: 365b7a9c21bd9373e49052c3e7b3e4646ddd4d43
        SHA256: c2abb7484da91a658548de089d52436175fdb760a1387d225611dc0613a1e2ff
        SHA384: eab4fe5ef90e0de4a6aa3a27769a5e879f588df5e4785aa4104debd1f81e19ea56d33e3a16e5facf99f68b5d8e3d287b
    - Subject: C=US, O=Symantec Corporation, CN=Symantec Time Stamping Services Signer
        , G4
      ValidFrom: '2012-10-18 00:00:00'
      ValidTo: '2020-12-29 23:59:59'
      Signature: 783bb4912a004cf08f62303778a38427076f18b2de25dca0d49403aa864e259f9a40031cddcee379cb216806dab632b46dbff42c266333e449646d0de6c3670ef705a4356c7c8916c6e9b2dfb2e9dd20c6710fcd9574dcb65cdebd371f4378e678b5cd280420a3aaf14bc48829910e80d111fcdd5c766e4f5e0e4546416e0db0ea389ab13ada097110fc1c79b4807bac69f4fd9cb60c162bf17f5b093d9b5be216ca13816d002e380da8298f2ce1b2f45aa901af159c2c2f491bdb22bbc3fe789451c386b182885df03db451a179332b2e7bb9dc20091371eb6a195bcfe8a530572c89493fb9cf7fc9bf3e226863539abd6974acc51d3c7f92e0c3bc1cd80475
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: false
      SerialNumber: 0ecff438c8febf356e04d86a981b1a50
      Version: 3
      CertificateType: Intermediate
      IsCodeSigning: false
      IsCA: false
      TBS:
        MD5: e9d38360b914c8863f6cba3ee58764d3
        SHA1: 4cba8eae47b6bf76f20b3504b98b8f062694a89b
        SHA256: 88901d86a4cc1f1bb193d08e1fb63d27452e63f83e228c657ab1a92e4ade3976
        SHA384: e9f2a75334a9e336c5a4712eadee88d0374b0fdc273262f4e65c9040ad2793067cc076696db5279a478773485e285652
    - Subject: C=US, ST=California, L=San Jose, O=Aquantia Corp., OU=IT, CN=Aquantia
        Corp.
      ValidFrom: '2018-11-06 00:00:00'
      ValidTo: '2020-11-05 23:59:59'
      Signature: 2853f6902e3ef0c34d9b5ddd86d1901bdf6bbb7d06b17d344e5afbfd7522b748b573f50b07d7445257c2856fef7a0675ede5e062932e8e19987468a99f82716f823667df93d95557151d99ae64920f3c8da868eb4f203518ae04d70c37b5fae1e0763100cef38ed698a93e35411a51a369c41c9eeae26526ea300d85bdf572b14dde2187605ec439badedc0d53c82d0209bf9baeae7dc1db6a2652726f8b9e1ad098647d90a1acbfe7af2db0871cf8ff363aa8551a14e244f4a0fc494c0b8ef2a2b12081813ee59411fbf6705eb9a69a955a2316cf8b962d7be8bce63022e530d817a5863232d3ed01a6b9adf58b0e4bef4a9c12e17942ec806cb2a1405be69d
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      IsCertificateAuthority: false
      SerialNumber: 7c3eead1d01e25d1efe1e3a788d520e8
      Version: 3
      CertificateType: Leaf (Code Signing)
      IsCodeSigning: true
      IsCA: false
      TBS:
        MD5: 72de81c11261fe09bcf8e625f61bf119
        SHA1: 5b1dfe2c24c571c2c5ead9824c2aa2c2cbc2f514
        SHA256: c0df23f328bcc3055572746dedad7427b548921bf757d8bf59e89ad321f08307
        SHA384: 0e73dd74284a89d8938530f40031b1838cc58ef25523d585222505d65f1a1d50b47f6c983acd36105c0e62b5e2412b33
    - Subject: C=US, O=Symantec Corporation, OU=Symantec Trust Network, CN=Symantec
        Class 3 SHA256 Code Signing CA
      ValidFrom: '2013-12-10 00:00:00'
      ValidTo: '2023-12-09 23:59:59'
      Signature: 13851a1e69a937f7a0bda4af7e1d6153fe9d8c5e0ca6751e781723ddfdec1a035539fb7195c7655aa78e30d2445a61db706fda2105c22e73ba49f1d193fe5dc9cd5e03e0899e3f741ed7f7388ba9d6cfbb352f3358a89256d1c84d3b82e6798416fc28b0b147f31da23eee87d9a67fa456a53fad842e29de7cbca8aaa33d0401eaba93a20e502229174c87e43a115fd6a425899b056b2fb4c9014c277b0bac190522a060153fdac9fb4d4c8ffb726777fd2794c7ba350e8849fe8dfd28af4a12bd0db39705de440c15fa362b03dcc15001f1a1115d14e5e2bd274b54be2b845e0fa6c374050aef97c38922b11f77f3bdcd43d4f14ca93fb58b84af64f2d01421
      SignatureAlgorithmOID: 1.2.840.113549.1.1.11
      IsCertificateAuthority: true
      SerialNumber: 3d78d7f9764960b2617df4f01eca862a
      Version: 3
      CertificateType: CA
      IsCodeSigning: true
      IsCA: true
      TBS:
        MD5: 1f056ff7d5f874984dc605402b7cb042
        SHA1: bdb348353a2203deb4b767914fa1bd7248dd728b
        SHA256: a08e79c386083d875014c409c13d144e0a24386132980df11ff59737c8489eb1
        SHA384: fa2729064b49e0d77540c1ee95d5f74acaf8eaf55197851a3a40383335f8113e51190bc48b552196edf8ac5cf0c89278
    - Subject: C=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=(c) 2006 VeriSign,
        Inc. , For authorized use only, CN=VeriSign Class 3 Public Primary Certification
        Authority , G5
      ValidFrom: '2011-02-22 19:25:17'
      ValidTo: '2021-02-22 19:35:17'
      Signature: 812a82168c34672be503eb347b8ca2a3508af45586f11e8c8eae7dee0319ce72951848ad6211fd20fd3f4706015ae2e06f8c152c4e3c6a506c0b36a3cf7a0d9c42bc5cf819d560e369e6e22341678c6883762b8f93a32ab57fbe59fba9c9b2268fcaa2f3821b983e919527978661ee5b5d076bcd86a8e26580a8e215e2b2be23056aba0cf347934daca48c077939c061123a050d89a3ec9f578984fbecca7c47661491d8b60f195de6b84aacbc47c8714396e63220a5dc7786fd3ce38b71db7b9b03fcb71d3264eb1652a043a3fa2ead59924e7cc7f233424838513a7c38c71b242228401e1a461f17db18f7f027356cb863d9cdb9645d2ba55eefc629b4f2c7f821cc04ba57fd01b6abc667f9e7d3997ff4f522fa72f5fdff3a1c423aa1f98018a5ee8d1cd4669e4501feaaeefffb178f30f7f1cd29c59decb5d549003d85b8cbbb933a276a49c030ae66c9f723283276f9a48356c848ce5a96aaa0cc0cc47fb48e97af6de35427c39f86c0d6e473089705dbd054625e0348c2d59f7fa7668cd09db04fd4d3985f4b7ac97fb22952d01280c70f54b61e67cdc6a06c110384d34875e72afeb03b6e0a3aa66b769905a3f177686133144706fc537f52bd92145c4a246a678caf8d90aad0f679211b93267cc3ce1ebd883892ae45c6196a4950b305f8ae59378a6a250394b1598150e8ba8380b72335f476b9671d5918ad208d94
      SignatureAlgorithmOID: 1.2.840.113549.1.1.5
      IsCertificateAuthority: true
      SerialNumber: 611993e400000000001c
      Version: 3
      CertificateType: CA
      IsCodeSigning: false
      IsCA: true
      TBS:
        MD5: 78a717e082dcc1cda3458d917e677d14
        SHA1: 4a872e0e51f9b304469cd1dedb496ee9b8b983a4
        SHA256: 317fa1d234ebc49040ebc5e8746f8997471496051b185a91bdd9dfbb23fab5f8
        SHA384: b71052da4eb9157c8c1a5d7f55df19d69b9128598b72fcca608e5b7cc7d64c43c5504b9c86355a6dc22ee40c88cc385c
    Signer:
    - SerialNumber: 7c3eead1d01e25d1efe1e3a788d520e8
      Issuer: C=US, O=Symantec Corporation, OU=Symantec Trust Network, CN=Symantec
        Class 3 SHA256 Code Signing CA
      Version: 1
  LoadsDespiteHVCI: 'FALSE'
