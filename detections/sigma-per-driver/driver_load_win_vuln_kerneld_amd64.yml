title: Driver Load - kerneld.amd64
id: ae94d5bd-c7ab-53d6-9461-c6966c9a60e8
status: experimental
description: |
    Detects loading of driver kerneld.amd64 via hash.
    The Carbon Black Threat Analysis Unit (TAU) discovered 34 unique vulnerable drivers (237 file hashes) accepting firmware access. Six allow kernel memory access. All give full control of the devices to non-admin users. By exploiting the vulnerable drivers, an attacker without the system privilege may erase/alter firmware, and/or elevate privileges. As of the time of writing in October 2023, the filenames of the vulnerable drivers have not been made public until now.
references:
    - https://www.loldrivers.io/drivers/3aa6e630-59be-4a15-a30c-aaed4c1edaf0/
    - https://blogs.vmware.com/security/2023/10/hunting-vulnerable-kernel-drivers.html
author: Takahiro Haruyama
date: 2023/11/02
modified: 2026/02/06
tags:
    - attack.privilege_escalation
    - attack.t1543.003
    - attack.t1068
    - loldrivers.vulnerable
logsource:
    product: windows
    category: driver_load
detection:
    selection_hashes:
        Hashes|contains:
            - 'MD5=648adec580746afbbf59904c1e150c73'
            - 'MD5=09e77d71d626574e6142894caca6e6dd'
            - 'MD5=0c7f66cd219817eaab41f36d4bc0d4cd'
            - 'MD5=f0e21ababe63668fb3fbd02e90cd1fa9'
            - 'MD5=198b723e13a270bb664dcb9fb6ed42e6'
            - 'MD5=009876ab9cf3a3d4e3fc3afe13ae839e'
            - 'MD5=723381977ce7df57ec623db52b84f426'
            - 'MD5=7575b35fee4ec8dbd0a61dbca3b972e3'
            - 'MD5=2b6a17ec50d3a21e030ed78f7acbd2af'
            - 'MD5=8a212a246b3c41f3ddce5888aaaaacd6'
            - 'MD5=2d854c6772f0daa8d1fde4168d26c36b'
            - 'MD5=b41dcdb2e710dffba2d8ea1defb0f087'
            - 'MD5=e99e86480d4206beb898dda82b71ca44'
            - 'MD5=7c887f2b1a56b84d86828529604957db'
            - 'MD5=5bbe4e52bd33f1cdd4cf38c7c65f80ae'
            - 'MD5=397580c24c544d477688fcfca9c9b542'
            - 'MD5=5c5973d2caf86e96311f6399513ab8df'
            - 'MD5=a730b97ab977aa444fa261902822a905'
            - 'MD5=eb7f6d01c97783013115ad1a2833401a'
            - 'MD5=25ede0fd525a30d31998ea62876961ec'
            - 'MD5=8f1255efd2ed0d3b03a02c6b236c06d6'
            - 'MD5=7ffdd78d63ca7307a96843cfe806799e'
            - 'MD5=0ec31f45e2e698a83131b4443f9a6dd7'
            - 'MD5=13a2b915f6d93e52505656773d53096f'
            - 'MD5=24589081b827989b52d954dcd88035d0'
            - 'MD5=17c7bcae7ebabb95af2f7c91b19c361c'
            - 'MD5=192519661fe6d132f233d0355c3f4a6d'
            - 'MD5=ab4656d1ec4d4cc83c76f639a5340e84'
            - 'MD5=1ad400766530669d14a077514599e7f3'
            - 'MD5=4a829b8cf1f8fdb69e1d58ae04e6106e'
            - 'MD5=b62e2371158a082e239f5883bd6000d1'
            - 'MD5=96fb2101f85fa81871256107bdd25169'
            - 'MD5=b3d6378185356326fd8ee4329b0b7698'
            - 'MD5=1caf5070493459ba029d988dbb2c7422'
            - 'MD5=03ca3b1cff154ab8855043abadd07956'
            - 'MD5=3af19d325f9dcdf360276ae5e7c136ea'
            - 'SHA1=43f53a739eda1e58f470e8e9ff9aa1437e5d9546'
            - 'SHA1=cd7b0c6b6ef809e7fb1f68ba36150eceabe500f7'
            - 'SHA1=52ea274e399df8706067fdc5ac52af0480461887'
            - 'SHA1=fb4ce6de14f2be00a137e8dde2c68bb5b137ab9c'
            - 'SHA1=b82c034e41d463f4e68b0a7d334f2d7611049bcb'
            - 'SHA1=f9cced7ccdc1f149ad8ad13a264c4425aee89b8e'
            - 'SHA1=76a756cc61653abcadd63db4a74c48d92607a861'
            - 'SHA1=c41ff2067634a1cce6b8ec657cdfd87e7f6974e3'
            - 'SHA1=f7330a6a4d9df2f35ab93a28c8ee1eb14a74be6e'
            - 'SHA1=6f8b0e1c7d7bd7beed853e0d51ca03f143e5b703'
            - 'SHA1=297fdf58e60d54bcddf2694c21ceb9da9ec17915'
            - 'SHA1=b394f84e093cb144568e18aaf5b857dff77091fa'
            - 'SHA1=64ff172bafc33f14ca5f2e35f9753d41e239a5e4'
            - 'SHA1=ba63502aaf8c5a7c2464e83295948447e938a844'
            - 'SHA1=8d3be83cf3bb36dbce974654b5330adb38792c2d'
            - 'SHA1=4a1a499857accc04b4d586df3f0e0c2b3546e825'
            - 'SHA1=9d44260558807daff61a0cc0c6a8719c3adacd2d'
            - 'SHA1=3aba6dd15260875eb290e9d67992066141aa0bb0'
            - 'SHA1=820d339fd3dbb632a790d6506ddf6aee925fcffe'
            - 'SHA1=1b25fbab2dbee5504dc94fbcc298cd8669c097a8'
            - 'SHA1=64879accdb4dbbaac55d91185c82f2b193f0c869'
            - 'SHA1=96047b280e0d6ddde9df1c79ca5f561219a0370d'
            - 'SHA1=adab368ed3c17b8f2dc0b2173076668b6153e03a'
            - 'SHA1=9f6883e59fd6c136cfc556b7b388a4c363dc0516'
            - 'SHA1=6b90a6eeef66bb9302665081e30bf9802ca956cc'
            - 'SHA1=d6b61c685cfaa36c85f1672ac95844f8293c70d0'
            - 'SHA1=f85f5e5d747433b274e53c8377bf24fbc08758b6'
            - 'SHA1=9d0b824892fbfb0b943911326f95cd0264c60f7d'
            - 'SHA1=9ec6f54c74bcc48e355226c26513a7240fd9462d'
            - 'SHA1=5ca6a52230507b1dffab7acd501540bc10f1ab81'
            - 'SHA1=d11659145d6627f3d93975528d92fb6814171f91'
            - 'SHA1=11fcaeda49848474cee9989a00d8f29cb727acb7'
            - 'SHA1=1b84abffd814b9f4595296b3e5ede0c44e630967'
            - 'SHA1=0b3836d5d98bc8862a380aae19caa3e77a2d93ef'
            - 'SHA1=336ed563ef96c40eece92a4d13de9f9b69991c8a'
            - 'SHA1=d43b2ac1221f2eaf2c170788280255cfef3edd72'
            - 'SHA256=76940e313c27c7ff692051fbf1fbdec19c8c31a6723a9de7e15c3c1bec8186f6'
            - 'SHA256=c6db7f2750e7438196ec906cc9eba540ef49ceca6dbd981038cef1dc50662a73'
            - 'SHA256=1336469ec0711736e742b730d356af23f8139da6038979cfe4de282de1365d3b'
            - 'SHA256=212c05b487cd4e64de2a1077b789e47e9ac3361efa24d9aab3cc6ad4bd3bd76a'
            - 'SHA256=8edab185e765f9806fa57153db1ede00e68270d2351443ee1de30674eca8d9b6'
            - 'SHA256=90574d2c406b9738aae8fc629c3983c5e47a6282a43b052f38b5dd313380c30a'
            - 'SHA256=e8b51ab681714e491ab1a59a7c9419db39db04b0dd7be11293f3a0951afe740e'
            - 'SHA256=d3b5fd13a53eee5c468c8bfde4bfa7b968c761f9b781bb80ccd5637ee052ee7d'
            - 'SHA256=dfe57c6a4ef4d2491be325d67428698a61d9c5d2a24dbada10043d313be2c8cc'
            - 'SHA256=680ddece32fe99f056e770cb08641f5b585550798dfdf723441a11364637c7e6'
            - 'SHA256=33bc9a17a0909e32a3ae7e6f089b7f050591dd6f3f7a8172575606bec01889ef'
            - 'SHA256=442f12adebf7cb166b19e8aead2b0440450fd1f33f5db384a39776bb2656474a'
            - 'SHA256=bd3cf8b9af255b5d4735782d3653be38578ff5be18846b13d05867a6159aaa53'
            - 'SHA256=db0d425708ba908aedf5f8762d6fdca7636ae3a537372889446176c0237a2836'
            - 'SHA256=f13f6a4bf7711216c9e911f18dfa2735222551fb1f8c1a645a8674c1983ccea6'
            - 'SHA256=51f002ee44e46889cf5b99a724dd10cc2bd3e22545e2a2cb3bd6b1dd3af5ba11'
            - 'SHA256=d330ab003206ce5e9828607562790aa8dd0453f6b7452f5c6053e3c6b6761d25'
            - 'SHA256=0c018eaa293c03febe2aef1e868fca782a06b49d7d2f9f388ae5fb57604c5250'
            - 'SHA256=38535a0e9fc0684308eb5d6aa6284669bc9743f11cb605b79883b8c13ef906ad'
            - 'SHA256=6ef0b34649186fb98a7431b606e77ee35e755894b038755ba98e577bd51b2c72'
            - 'SHA256=bac7e75745d0cb8819de738b73edded02a07111587c4531383dccd4562922b65'
            - 'SHA256=f64a78b1294e6837f12f171a663d8831f232b1012fd8bae3c2c6368fbf71219b'
            - 'SHA256=a188760f1bf36584a2720014ca982252c6bcd824e7619a98580e28be6090dccc'
            - 'SHA256=18047c2d45758a43d6b7e56bcd4aa90354c899795baf944f037850c48d8e892a'
            - 'SHA256=065a34b786b0ccf6f88c136408943c3d2bd3da14357ee1e55e81e05d67a4c9bc'
            - 'SHA256=9917144b7240b1ce0cadb1210fd26182744fbbdf145943037c4b93e44aced207'
            - 'SHA256=748ccadb6bf6cdf4c5a5a1bb9950ee167d8b27c5817da71d38e2bc922ffce73d'
            - 'SHA256=582b62ffbcbcdd62c0fc624cdf106545af71078f1edfe1129401d64f3eefaa3a'
            - 'SHA256=b074caef2fbf7e1dc8870edccb65254858d95836f466b4e9e6ca398bf7a27aa3'
            - 'SHA256=b1e4455499c6a90ba9a861120a015a6b6f17e64479462b869ad0f05edf6552de'
            - 'SHA256=e9919d1546c7dfef62ff01b87f739812de0a57463611c12012013ae689023ce1'
            - 'SHA256=125e4475a5437634cab529da9ea2ef0f4f65f89fb25a06349d731f283c27d9fe'
            - 'SHA256=bae4372a9284db52dedc1c1100cefa758b3ec8d9d4f0e5588a8db34ded5edb1f'
            - 'SHA256=6297556f66cd6619057f3a5b216b314f8a27eebb5fa575ee07a1944aca71ae80'
            - 'SHA256=cb59a641adb623a65a9b5af1db2ffd921fd1ca1bc046a6df85d5f2e00fd0b5a5'
            - 'SHA256=53b9e423baf946983d03ce309ec5e006ba18c9956dcd97c68a8b714d18c8ffcf'
            - 'IMPHASH=f212bbc758bb52fc661839b1d194b76e'
            - 'IMPHASH=a387f215b4964a3ca2e3c92f235a6d1b'
            - 'IMPHASH=c52384bc825d2414de3195672971339e'
            - 'IMPHASH=37b1eada43ad08093dfa4de7a411d15f'
            - 'IMPHASH=9fb64527ca6d4541cc256b1abd1e4101'
            - 'IMPHASH=540992ba6f31301ba27604515a78ad79'
            - 'IMPHASH=8232d2f79ce126e84cc044543ad82790'
            - 'IMPHASH=9e2cf28fe320bbf74972509536569c8e'
            - 'IMPHASH=d232ae5bad7ce02f4eece90ef370c7a0'
            - 'IMPHASH=3198fc43051f03c6c71587dbf232f75c'
            - 'IMPHASH=b6f67458e30912358144df4adf5264fd'
            - 'IMPHASH=9a970527986cd03e5a25d18b372624a1'
            - 'IMPHASH=fd894d394a8ca9abd74f7210ed931682'
            - 'IMPHASH=f4fa225abfb5a5263241a01a2c3f2b8f'
            - 'IMPHASH=14075e605bff546182d682f41afefea2'
            - 'IMPHASH=dcd41632f0ad9683e5c9c7cc083f78f7'
            - 'IMPHASH=12fef92a55cb5e1533b89d8e6a5892b2'
            - 'IMPHASH=87fde0c3f8e7dff7ab0d718d6b1252c8'
    condition: selection_hashes
falsepositives:
    - Unknown
level: high
