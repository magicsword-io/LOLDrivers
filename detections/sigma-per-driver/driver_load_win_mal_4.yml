title: Driver Load - 4.sys
id: 32e81e2c-afda-58ad-bd5e-b492f3eafdc2
status: experimental
description: |
    Detects loading of driver 4.sys via hash.
    SentinelOne has observed prominent threat actors abusing legitimately signed Microsoft drivers in active intrusions into telecommunication, BPO, MSSP, and financial services businesses.
    Investigations into these intrusions led to the discovery of POORTRY and STONESTOP malware, part of a small toolkit designed to terminate AV and EDR processes.
    We first reported our discovery to Microsoftâ€™s Security Response Center (MSRC) in October 2022 and received an official case number (75361). Today, MSRC released an associated advisory under ADV220005.
    This research is being released alongside Mandiant, a SentinelOne technology and incident response partner.
references:
    - https://www.loldrivers.io/drivers/05d7cfea-1fb9-4559-8837-d97b713254fe/
    - https://www.sentinelone.com/labs/driving-through-defenses-targeted-attacks-leverage-signed-malicious-microsoft-drivers/
author: Michael Haag
date: 2023/03/04
modified: 2026/02/06
tags:
    - attack.privilege_escalation
    - attack.t1543.003
    - attack.t1068
    - loldrivers.malicious
logsource:
    product: windows
    category: driver_load
detection:
    selection_hashes:
        Hashes|contains:
            - 'MD5=6fcf56f6ca3210ec397e55f727353c4a'
            - 'SHA1=6debce728bcff73d9d1d334df0c6b1c3735e295c'
            - 'SHA256=8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104'
            - 'IMPHASH=2a008187d4a73284ddcc43f1b727b513'
    condition: selection_hashes
falsepositives:
    - Unknown
level: high
