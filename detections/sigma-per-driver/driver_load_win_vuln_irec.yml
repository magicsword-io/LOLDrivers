title: Driver Load - irec.sys
id: 73333d50-e62c-5704-a7c1-3bb6dc8e63b0
status: experimental
description: |
    Detects loading of driver irec.sys via hash.
    The driver in question, identified as \\.\IREC, provides an interface for external programs to directly interact with system processes. Its key functionality is encapsulated in the OPENPROCESS function which, upon receiving a Process ID (PID), returns a handle to that specific process operating within the kernels domain. The vulnerability emerges from the indiscriminate nature of this functionality. An ill-intentioned actor can exploit this to obtain handles to critical processes like LSASS. With a hardcoded access mask of 0x410, this driver essentially grants PROCESS_QUERY_INFORMATION and PROCESS_VM_READ permissions, enabling unauthorized memory dumps from privileged processes, all from an unprivileged context.
references:
    - https://www.loldrivers.io/drivers/d74fdf19-b4b0-4ec2-9c29-4213b064138b/
    - https://blog.dru1d.ninja/windows-driver-exploit-development-irec-sys-a5eb45093945
    - https://gist.github.com/dru1d-foofus/1af21179f253879f101c3a8d4f718bf0
    - https://www.binalyze.com/irec
author: Nasreddine Bencherchali
date: 2023/05/11
modified: 2026/02/06
tags:
    - attack.privilege_escalation
    - attack.t1543.003
    - attack.t1068
    - loldrivers.vulnerable
logsource:
    product: windows
    category: driver_load
detection:
    selection_hashes:
        Hashes|contains:
            - 'MD5=f1a203406a680cc7e4017844b129dcbf'
            - 'SHA1=d2fb46277c36498e87d0f47415b7980440d40e3d'
            - 'SHA256=dd573f23d656818036fc9ae1064eda31aca86acb9bc44a6e127db3ea112a9094'
            - 'IMPHASH=3ee1cb6085fbe05e46e2b88493426848'
    condition: selection_hashes
falsepositives:
    - Unknown
level: high
