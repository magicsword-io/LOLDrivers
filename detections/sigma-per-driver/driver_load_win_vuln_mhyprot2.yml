title: Driver Load - Mhyprot2.sys
id: 7d58fcd8-88ec-5aeb-b7cf-d859a0100c17
status: experimental
description: |
    Detects loading of driver Mhyprot2.sys via hash.
references:
    - https://www.loldrivers.io/drivers/57354c82-ff9c-4a54-8377-d195e4ff0a26/
    - https://github.com/namazso/physmem_drivers
    - https://github.com/jbaines-r7/dellicious
    - https://www.rapid7.com/blog/post/2021/12/13/driver-based-attacks-past-and-present/
    - https://github.com/elastic/protections-artifacts/blob/932baf346cc8a743f1963ad3d4565b42ed17bebe/yara/rules/Windows_VulnDriver_Mhyprot.yar
    - https://gist.github.com/mgraeber-rc/1bde6a2a83237f17b463d051d32e802c
    - https://github.com/kagurazakasanae/Mhyprot2DrvControl/tree/main
author: Nasreddine Bencherchali, Michael Haag
date: 2023/01/09
modified: 2026/02/06
tags:
    - attack.privilege_escalation
    - attack.t1543.003
    - attack.t1068
    - loldrivers.vulnerable
logsource:
    product: windows
    category: driver_load
detection:
    selection_hashes:
        Hashes|contains:
            - 'MD5=a2c5f994e9b4a74b2f5b51c7a44c4401'
            - 'MD5=8f47af49c330c9fcf3451ad2252b9e04'
            - 'MD5=9c8fffef24fc480917236f9a20b80a47'
            - 'MD5=8b779fe1d71839ad361226f66f1b3fe5'
            - 'MD5=89c7bd12495e29413038224cb61db02e'
            - 'MD5=4b817d0e7714b9d43db43ae4a22a161e'
            - 'MD5=67e3b720cee8184c714585a85f8058a0'
            - 'MD5=d717f8de642b65f029829c34fbd13a45'
            - 'MD5=dc358c301fb463c2f4e7edb028dfe7e8'
            - 'MD5=6b2df08bacf640cc2ac6f20c76af07ee'
            - 'SHA1=175fb76c7cd8f0aeb916f4acb3b03f8b2d51846a'
            - 'SHA1=35a817d949b2eab012506bed0a3b4628dd884471'
            - 'SHA1=2c2fc258871499b206963c0f933583cedcdf9ea2'
            - 'SHA1=6210dabb908cc750379cc7563beb884b3895e046'
            - 'SHA1=8f8a0b813ada9886d2d32fc41b74fb5c3a32177d'
            - 'SHA1=16c6bcef489f190a48e9d3b1f35972db89516479'
            - 'SHA1=296757d5663290f172e99e60b9059f989cba4c4e'
            - 'SHA1=be797c91768ac854bd3b82a093e55db83da0cb11'
            - 'SHA1=0466e90bf0e83b776ca8716e01d35a8a2e5f96d3'
            - 'SHA1=254dce914e13b90003b0ae72d8705d92fe7c8dd0'
            - 'SHA256=ad2477632b9b07588cfe0e692f244c05fa4202975c1fe91dd3b90fa911ac6058'
            - 'SHA256=46cf46e1073b7c99142964b7c4bef1e5285fabcf2c6dbe5be99000a393d9f474'
            - 'SHA256=69e3fda487a5ec2ec0f67b7d79a5a836ff0036497b2d1aec514c67d2efa789b2'
            - 'SHA256=509628b6d16d2428031311d7bd2add8d5f5160e9ecc0cd909f1e82bbbb3234d6'
            - 'SHA256=b8b94c2646b62f6ac08f16514b6efaa9866aa3c581e4c0435a7aeafe569b2418'
            - 'SHA256=6e76764d750ebd835aa4bb055830d278df530303585614c1dc743f8d5adf97d7'
            - 'SHA256=0c512b615eac374d4d494e3c36838d8e788b3dc2691bf27916f7f42694b14467'
            - 'SHA256=342cf884840fc2b48c96398f690a1801ed8ac1ea59305af9e3d070d13ef85601'
            - 'SHA256=26d69e677d30bb53c7ac7f3fce76291fe2c44720ef17ee386f95f08ec5175288'
            - 'SHA256=247aadaf17ed894fcacf3fc4e109b005540e3659fd0249190eb33725d3d3082f'
            - 'IMPHASH=4b0b017b23567cf8b9e1268957acd032'
            - 'IMPHASH=5095ddaed3abc22c1510a141d72735cc'
            - 'IMPHASH=a74f61fdcea718cb9579907b2caf54ab'
            - 'IMPHASH=409d2ab916237fb129c57aacbb7cb4fe'
            - 'IMPHASH=82525a4a571f0f8d4e4f42ec6bb3900e'
            - 'IMPHASH=ebb99842fa08915eb8b7f67d8dc7a13a'
    condition: selection_hashes
falsepositives:
    - Unknown
level: high
