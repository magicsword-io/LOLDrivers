title: Driver Load - iqvw64e.sys
id: 053a8d67-5fd2-5e73-94df-8b91f9a67441
status: experimental
description: |
    Detects loading of driver iqvw64e.sys via hash.
    (1) IQVW32.sys before 1.3.1.0 and (2) IQVW64.sys before 1.3.1.0 in the Intel Ethernet diagnostics driver for Windows allows local users to cause a denial of service or possibly execute arbitrary code with kernel privileges via a crafted (a) 0x80862013, (b) 0x8086200B, (c) 0x8086200F, or (d) 0x80862007 IOCTL call.
references:
    - https://www.loldrivers.io/drivers/1d2cdef1-de44-4849-80e5-e2fa288df681/
    - https://www.crowdstrike.com/blog/scattered-spider-attempts-to-avoid-detection-with-bring-your-own-vulnerable-driver-tactic/
    - https://expel.com/blog/well-that-escalated-quickly-how-a-red-team-went-from-domain-user-to-kernel-memory/
    - https://github.com/Exploitables/CVE-2015-2291
    - https://github.com/Tare05/Intel-CVE-2015-2291
    - https://github.com/TheCruZ/kdmapper
    - https://gist.github.com/k4nfr3/af970e7facb09195e56f2112e1c9549c
author: Michael Haag, Guus Verbeek
date: 2023/01/09
modified: 2026/02/06
tags:
    - attack.privilege_escalation
    - attack.t1543.003
    - attack.t1068
    - loldrivers.vulnerable
logsource:
    product: windows
    category: driver_load
detection:
    selection_hashes:
        Hashes|contains:
            - 'MD5=1898ceda3247213c084f43637ef163b3'
            - 'MD5=69ba501a268f09f694ff0e8e208aa20e'
            - 'SHA1=3d6d53b0f1cc908b898610227b9f1b9352137aba'
            - 'SHA1=d04e5db5b6c848a29732bfd52029001f23c3da75'
            - 'SHA256=37c637a74bf20d7630281581a8fae124200920df11ad7cd68c14c26cc12c5ec9'
            - 'SHA256=4429f32db1cc70567919d7d47b844a91cf1329a6cd116f582305f3b7b60cd60b'
            - 'IMPHASH=2cf48a541dc193e91bb2a831adcf278e'
            - 'IMPHASH=55db306bc2be3ff71a6b91fd9db051b8'
    condition: selection_hashes
falsepositives:
    - Unknown
level: high
