title: Driver Load - procexp.Sys
id: b9400cc3-39d1-55e9-9665-b0f3c83f092f
status: experimental
description: |
    Detects loading of driver procexp.Sys via hash.
    Process Explorer
references:
    - https://www.loldrivers.io/drivers/0567c6c4-282f-406f-9369-7f876b899c25/
    - Internal Research
    - https://malware.news/t/lazarus-group-attack-case-using-vulnerability-of-certificate-software-commonly-used-by-public-institutions-and-universities/67715
    - https://waawaa.github.io/en/Bypass-PPL-Using-Process-Explorer/
    - https://github.com/magicsword-io/LOLDrivers/issues/57
    - https://github.com/elastic/protections-artifacts/search?q=VulnDriver
    - https://github.com/Yaxser/Backstab/blob/master/resources/PROCEXP.sys
    - https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/
    - https://github.com/magicsword-io/LOLDrivers/issues/55#issuecomment-1537161951
author: Nasreddine Bencherchali
date: 2023/05/06
modified: 2026/02/06
tags:
    - attack.privilege_escalation
    - attack.t1543.003
    - attack.t1068
    - loldrivers.vulnerable
logsource:
    product: windows
    category: driver_load
detection:
    selection_hashes:
        Hashes|contains:
            - 'MD5=ad03f225247b58a57584b40a4d1746d3'
            - 'MD5=fea9319d67177ed6f36438d2bd9392fb'
            - 'MD5=e6cb1728c50bd020e531d19a14904e1c'
            - 'MD5=c06dda757b92e79540551efd00b99d4b'
            - 'MD5=97e3a44ec4ae58c8cc38eefc613e950e'
            - 'MD5=da6f7407c4656a2dbaf16a407aff1a38'
            - 'MD5=9beecfb3146f19400880da61476ef940'
            - 'MD5=eeb8e039f6d942538eb4b0252117899a'
            - 'MD5=f9d04e99e4cab90973226a4555bc6d57'
            - 'MD5=b7ca4c32c844df9b61634052ae276387'
            - 'MD5=cec257dcac9e708cefb17f8984dd0a70'
            - 'MD5=b79475c4783efdd8122694c6b5669a79'
            - 'MD5=9b9d367cb53df0a2e0850760c840d016'
            - 'MD5=0ef05030abd55ba6b02faa2c0970f67f'
            - 'MD5=e4a0bba88605d4c07b58a2cc3fac0fe9'
            - 'MD5=659a59d7e26b7730361244e12201378e'
            - 'MD5=8e78ab9b9709bafb11695a0a6eddeff9'
            - 'MD5=c56a9ed0192c5a2b39691e54f2132a2f'
            - 'MD5=2e219df70fccb79351f0452cba86623e'
            - 'MD5=9982da703f13140997e137b1e745a2e3'
            - 'MD5=92927c47d6ff139c9b19674c9d0088f6'
            - 'MD5=318e309e11199ec69d8928c46a4d901b'
            - 'MD5=c69c292e0b76b25a5fa0e16136770e11'
            - 'MD5=880686bceaf66bfde3c80569eb1ebfa7'
            - 'MD5=6b3abe55c4d39e305a11b4d1091dfaac'
            - 'MD5=a91a1bc393971a662a3210dac8c17dfd'
            - 'MD5=90f8c1b76f786814d03ef4c51d4abb6d'
            - 'MD5=bf74d0706f5ab9c34067192260f4efb0'
            - 'MD5=6ff59faea912903af0ba8e80e58612bc'
            - 'SHA1=d5beca70469e0dcb099ba35979155e7c91876fd2'
            - 'SHA1=2740cd167a9ccb81c8e8719ce0d2ae31babc631c'
            - 'SHA1=05eff2001f595f9e2894c6b5eee756ae72379a6d'
            - 'SHA1=e4fcb363cfe9de0e32096fa5be94a41577a89bb0'
            - 'SHA1=6b090c558b877b6abb0d1051610cadbc6335ecbb'
            - 'SHA1=511b06898770337609ee065547dbf14ce3de5a95'
            - 'SHA1=9099482b26e9ba8e1d303418afc9111a3bffd6b3'
            - 'SHA1=96ec8c16f6a54b48e9a7f0d0416a529f4bf9ac11'
            - 'SHA1=6df6d5b30d04b9adb9d2c99de18ed108b011d52b'
            - 'SHA1=e525f54b762c10703c975132e8fc21b6cd88d39b'
            - 'SHA1=ac31d15851c0af14d60cfce23f00c4b7887d3cb7'
            - 'SHA1=bebf97411946749b9050989d9c40352dbe8269ea'
            - 'SHA1=2f9b0cd96d961e49d5d3b416028fd3a0e43d6a28'
            - 'SHA1=3296844d22c87dd5eba3aa378a8242b41d59db7a'
            - 'SHA1=631fdd1ef2d6f2d98e36f8fc7adbf90fbfb0a1e8'
            - 'SHA1=d1c38145addfed1bcd1b400334ff5a5e2ef9a5c6'
            - 'SHA1=bc47e15537fa7c32dfefd23168d7e1741f8477ed'
            - 'SHA1=c21510569fd84a5fe04508aa28e3cf9c8cc45b7a'
            - 'SHA1=1c537fd17836283364349475c6138e6667cf1164'
            - 'SHA1=2dd916cb8a9973b5890829361c1f9c0d532ba5d6'
            - 'SHA1=d612165251d5f1dcfb1f1a762c88d956f49ce344'
            - 'SHA1=a98734cd388f5b4b3caca5ce61cb03b05a8ad570'
            - 'SHA1=ed40c1f7da98634869b415530e250f4a665a8c48'
            - 'SHA1=f6d826d73bf819dbc9a058f2b55c88d6d4b634e3'
            - 'SHA1=10b9ae9286837b3bf6a00771c7e81adbdea3cbfe'
            - 'SHA1=63bb17160115f16b3fca1f028b13033af4e468c6'
            - 'SHA1=da361c56c18ea98e1c442aac7c322ff20f64486b'
            - 'SHA1=db6170ee2ee0a3292deceb2fc88ef26d938ebf2d'
            - 'SHA1=736531c76b8d9c56e26561bf430e10ecabff0186'
            - 'SHA256=89b9823ed974a5b71de8468324d45b7e9d6dc914f93615ba86c6209b25b3cbf7'
            - 'SHA256=3ff39728f1c11d1108f65ec5eb3d722fd1a1279c530d79712e0d32b34880baaa'
            - 'SHA256=46621554728bc55438c7c241137af401250f062edef6e7efecf1a6f0f6d0c1f7'
            - 'SHA256=9b6a84f7c40ea51c38cc4d2e93efb3375e9d98d4894a85941190d94fbe73a4e4'
            - 'SHA256=86721ee8161096348ed3dbe1ccbf933ae004c315b1691745a8af4a0df9fed675'
            - 'SHA256=bced04bdefad6a08c763265d6993f07aa2feb57d33ed057f162a947cf0e6668f'
            - 'SHA256=cdfbe62ef515546f1728189260d0bdf77167063b6dbb77f1db6ed8b61145a2bc'
            - 'SHA256=440883cd9d6a76db5e53517d0ec7fe13d5a50d2f6a7f91ecfc863bc3490e4f5c'
            - 'SHA256=d6827cd3a8f273a66ecc33bb915df6c7dea5cc1b8134b0c348303ef50db33476'
            - 'SHA256=6e944ae1bfe43a8a7cd2ea65e518a30172ce8f31223bdfd39701b2cb41d8a9e7'
            - 'SHA256=88e2e6a705d3fb71b966d9fb46dc5a4b015548daf585fb54dfcd81dc0bd3ebdc'
            - 'SHA256=59b09bd69923c0b3de3239e73205b1846a5f69043546d471b259887bb141d879'
            - 'SHA256=c089a31ac95d41ed02d1e4574962f53376b36a9e60ff87769d221dc7d1a3ecfa'
            - 'SHA256=1b00d6e5d40b1b84ca63da0e99246574cdd2a533122bc83746f06c0d66e63a6e'
            - 'SHA256=f29073dc99cb52fa890aae80037b48a172138f112474a1aecddae21179c93478'
            - 'SHA256=3503ea284b6819f9cb43b3e94c0bb1bf5945ccb37be6a898387e215197a4792a'
            - 'SHA256=30abc0cc700fdebc74e62d574addc08f6227f9c7177d9eaa8cbc37d5c017c9bb'
            - 'SHA256=bdbceca41e576841cad2f2b38ee6dbf92fd77fbbfdfe6ecf99f0623d44ef182c'
            - 'SHA256=3c7e5b25a33a7805c999d318a9523fcae46695a89f55bbdb8bb9087360323dfc'
            - 'SHA256=51e91dd108d974ae809e5fc23f6fbd16e13f672f86aa594dae4a5c4bc629b0b5'
            - 'SHA256=7a48f92a9c2d95a72e18055cac28c1e7e6cad5f47aa735cbea5c3b82813ccfaf'
            - 'SHA256=6bfc0f425de9f4e7480aa2d1f2e08892d0553ed0df1c31e9bf3d8d702f38fa2e'
            - 'SHA256=e07211224b02aaf68a5e4b73fc1049376623793509d9581cdaee9e601020af06'
            - 'SHA256=9d5ebd0f4585ec20a5fe3c5276df13ece5a2645d3d6f70cedcda979bd1248fc2'
            - 'SHA256=075de997497262a9d105afeadaaefc6348b25ce0e0126505c24aa9396c251e85'
            - 'SHA256=16a2e578bc8683f17a175480fea4f53c838cfae965f1d4caa47eaf9e0b3415c1'
            - 'SHA256=77950e2a40ac0447ae7ee1ee3ef1242ce22796a157074e6f04e345b1956e143c'
            - 'SHA256=e3f2ee22dec15061919583e4beb8abb3b29b283e2bcb46badf2bfde65f5ea8dd'
            - 'SHA256=98a123b314cba2de65f899cdbfa386532f178333389e0f0fbd544aff85be02eb'
            - 'IMPHASH=ebf30b4cd57a4f4548a03eab0f6c418c'
            - 'IMPHASH=bfe13c695e41d3eee414d3929b1bd523'
            - 'IMPHASH=505e0a016962137ca6169bce64ba2f53'
            - 'IMPHASH=9376f1c4ab79240cc948b77bf9e8814b'
            - 'IMPHASH=d122c1eaa50839be14c31876d0d4e0be'
            - 'IMPHASH=421730c2b3fa3a7d78c2eda3da1be6a8'
            - 'IMPHASH=0b40636205c64cacfd2e4f407518ad58'
            - 'IMPHASH=5bb79a6caa12076a6d140085cb53892e'
            - 'IMPHASH=3c9af2347198d96c8ab5b189b4e3db37'
            - 'IMPHASH=8a5edbe5251fe141ea0262d5d572178b'
            - 'IMPHASH=4792bcb395d06f9efb72e8020c4af5e6'
            - 'IMPHASH=f27327907e57c0c2c9fddc68eab2eb7b'
            - 'IMPHASH=b8a35d469bc164d86ac7c64e93b0037b'
    condition: selection_hashes
falsepositives:
    - Unknown
level: high
