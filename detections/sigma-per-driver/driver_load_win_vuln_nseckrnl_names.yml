title: Driver Load - NSecKrnl.sys
id: 23a24186-411f-58a1-835f-177cc98a4bb0
status: experimental
description: |
    Detects loading of driver NSecKrnl.sys via name.
    Driver used by ValleyRAT malware to terminate security processes via IOCTL 0x2248E0
references:
    - https://www.loldrivers.io/drivers/c1143cd9-a709-4323-9678-2117285d1b47/
    - https://hexastrike.com/resources/blog/threat-intelligence/valleyrat-exploiting-byovd-to-kill-endpoint-security/
author: Michael Haag
date: 2025/09/18
modified: 2026/02/06
tags:
    - attack.privilege_escalation
    - attack.t1543.003
    - attack.t1068
    - loldrivers.vulnerable
logsource:
    product: windows
    category: driver_load
detection:
    selection_name:
        ImageLoaded|endswith:
            - '\nseckrnl.sys'
    condition: selection_name
falsepositives:
    - Unknown
level: low
